!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Decode=e()}(this,(function(){"use strict";const t=t=>"number"==typeof t&&!isNaN(t)&&isFinite(t),e=t=>t instanceof Array,r=t=>"object"==typeof t&&null!==t&&!e(t),n=(t,e)=>({type:"IN_FIELD",name:t,error:e}),s=(t,e)=>({type:"AT_INDEX",position:t,error:e}),u=(t,e)=>({type:"FAILURE",message:t,source:e}),i=t=>({type:"EXPECT_OBJECT",source:t}),o=t=>({type:"EXPECT_ARRAY",source:t}),c=t=>({error:t}),h=t=>({value:t});class l{map(t){return new f(t,this)}chain(t){return new a(t,this)}decodeJSON(t){try{return this.decode(JSON.parse(t))}catch(e){return c(((t,e)=>({type:"INVALID_JSON",error:t,source:e}))(e,t))}}decode(t){try{return this.run(t)}catch(t){return c({type:"RUNTIME_EXCEPTION",error:t})}}}class f extends l{constructor(t,e){super(),this.t=t,this.decoder=e}run(t){const e=this.decoder.decode(t);return null!=e.error?e:h(this.t(e.value))}}class a extends l{constructor(t,e){super(),this.t=t,this.decoder=e}run(t){const e=this.decoder.decode(t);return null!=e.error?e:this.t(e.value).decode(t)}}class p extends l{constructor(t,e){super(),this.u=t,this.i=e}run(t){return this.i(t)?h(t):c(this.u(t))}}class d extends l{constructor(t,e){super(),this.o=t,this.h=e}run(t){return t===this.o?h(this.h):c({type:"EXPECT_EXACT",value:this.o,source:t})}}class y extends l{constructor(t){super(),this.l=t}run(t){return c(u(this.l,t))}}class E extends l{constructor(t){super(),this.h=t}run(){return h(this.h)}}class w extends l{constructor(t){super(),this.p=t}run(t){if(null==t)return h(null);const e=this.p.decode(t);return null!=e.error?c({type:"OPTIONAL",error:e.error}):e}}class x extends l{constructor(t,e){super(),this.O=t,this.g=e}run(t){if(!r(t))return c(i(t));const e=[];for(const r of Object.keys(t)){const s=this.O(r);if(null!=s.error)return c(u(s.error,r));const i=this.g.decode(t[r]);if(null!=i.error)return c(n(r,i.error));e.push([s.value,i.value])}return h(e)}}class O extends l{constructor(t){super(),this.g=t}run(t){if(!r(t))return c(i(t));const e={};for(const r of Object.keys(t)){const s=this.g.decode(t[r]);if(null!=s.error)return c(n(r,s.error));e[r]=s.value}return h(e)}}class g extends l{constructor(t){super(),this.N=t}run(t){const e={};for(const r of Object.keys(this.N)){const n=this.N[r].decode(t);if(null!=n.error)return n;e[r]=n.value}return h(e)}}class N extends l{constructor(t){super(),this.g=t}run(t){if(!e(t))return c(o(t));const r=Array(t.length);for(let e=0;t.length>e;e++){const n=this.g.decode(t[e]);if(null!=n.error)return c(s(e,n.error));r[e]=n.value}return h(r)}}class T extends l{constructor(t){super(),this.T=t}run(t){const e=[];for(const r of this.T){const n=r.decode(t);if(null==n.error)return n;e.push(n.error)}return c((t=>({type:"ONE_OF",errors:t}))(e))}}class _ extends l{constructor(t,e){super(),this._=t,this.p=e}fieldNotDefined(t){return c({type:"REQUIRED_FIELD",name:this._,source:t})}run(t){if(!r(t))return c(i(t));if(!Object.prototype.hasOwnProperty.call(t,this._))return this.fieldNotDefined(t);const e=this.p.decode(t[this._]);return null!=e.error?c(n(this._,e.error)):e}}class I extends _{fieldNotDefined(){return h(null)}}class b extends l{constructor(t,e){super(),this.I=t,this.p=e}outOfRange(t){return c({type:"REQUIRED_INDEX",position:this.I,source:t})}run(t){if(!e(t))return c(o(t));if(0>this.I||this.I>=t.length)return this.outOfRange(t);const r=this.p.decode(t[this.I]);return null!=r.error?c(s(this.I,r.error)):r}}class A extends b{outOfRange(){return h(null)}}class R{constructor(t){this.A=t}R(t){return this.A(new w(t))}get string(){return this.R(P)}get boolean(){return this.R(m)}get int(){return this.R(L)}get float(){return this.R(j)}list(t){return this.R(V(t))}record(t){return this.R(J(t))}keyValue(...t){return this.R(v(t))}field(t){return Q((e=>this.R(new I(t,e))))}index(t){return Q((e=>this.R(new A(t,e))))}}class X{constructor(t){this.createDecoder=t}of(t){return this.createDecoder(t)}get optional(){return new R(this.createDecoder)}get unknown(){return this.of(D)}get string(){return this.of(P)}get boolean(){return this.of(m)}get int(){return this.of(L)}get float(){return this.of(j)}exact(...t){return this.of(k(t))}lazy(t){return this.of(B(t))}list(t){return this.of(V(t))}tuple(...t){return this.of(U(t))}record(t){return this.of(J(t))}shape(t){return this.of(S(t))}keyValue(...t){return this.of(v(t))}oneOf(...t){return this.of(z(t))}field(t){return Q((e=>this.of(new _(t,e))))}index(t){return Q((e=>this.of(new b(t,e))))}}const C=new R((t=>t)),D=new class extends l{run(t){return h(t)}},P=new p((t=>({type:"EXPECT_STRING",source:t})),(t=>"string"==typeof t)),m=new p((t=>({type:"EXPECT_BOOLEAN",source:t})),(t=>"boolean"==typeof t)),L=new p((t=>({type:"EXPECT_INT",source:t})),(e=>t(e)&&/^(\+|-)?\d+$/.test(""+e))),j=new p((t=>({type:"EXPECT_FLOAT",source:t})),t);function F(t){return new E(t)}const k=t=>new d(t[0],1===t.length?t[0]:t[1]),J=t=>new O(t),S=t=>new g(t),U=t=>{const r=1===t.length&&e(t[0])?t[0]:t,n={},s=r.length;for(let t=0;s>t;t++)n[t]=r[t];return S(n).map((t=>{const e=Array(s);for(let r=0;s>r;r++)e[r]=t[r];return e}))},V=t=>new N(t),v=t=>{const[e,r]=1===t.length?[h,t[0]]:t;return new x(e,r)},z=t=>1===t.length&&e(t[0])?new T(t[0]):new T(t),B=t=>F(null).chain(t),Q=t=>new X((e=>t(e)));return{optional:C,field:t=>Q((e=>new _(t,e))),index:t=>Q((e=>new b(t,e))),unknown:D,string:P,boolean:m,int:L,float:j,exact:(...t)=>k(t),record:J,list:V,keyValue:(...t)=>v(t),shape:S,tuple:(...t)=>U(t),oneOf:(...t)=>z(t),lazy:B,fail:function(t){return new y(t)},succeed:F}}));
//# sourceMappingURL=decode-json.min.js.map
