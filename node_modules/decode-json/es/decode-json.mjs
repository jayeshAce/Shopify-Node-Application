const t=t=>"number"==typeof t&&!isNaN(t)&&isFinite(t),r=t=>t instanceof Array,e=t=>"object"==typeof t&&null!==t&&!r(t),n=(t,r)=>({type:"IN_FIELD",name:t,error:r}),s=(t,r)=>({type:"AT_INDEX",position:t,error:r}),u=(t,r)=>({type:"FAILURE",message:t,source:r}),i=t=>({type:"EXPECT_OBJECT",source:t}),o=t=>({type:"EXPECT_ARRAY",source:t}),c=t=>({error:t}),h=t=>({value:t});class l{map(t){return new a(t,this)}chain(t){return new f(t,this)}decodeJSON(t){try{return this.decode(JSON.parse(t))}catch(r){return c(((t,r)=>({type:"INVALID_JSON",error:t,source:r}))(r,t))}}decode(t){try{return this.run(t)}catch(t){return c({type:"RUNTIME_EXCEPTION",error:t})}}}class a extends l{constructor(t,r){super(),this.t=t,this.decoder=r}run(t){const r=this.decoder.decode(t);return null!=r.error?r:h(this.t(r.value))}}class f extends l{constructor(t,r){super(),this.t=t,this.decoder=r}run(t){const r=this.decoder.decode(t);return null!=r.error?r:this.t(r.value).decode(t)}}class p extends l{constructor(t,r){super(),this.u=t,this.i=r}run(t){return this.i(t)?h(t):c(this.u(t))}}class d extends l{constructor(t,r){super(),this.o=t,this.h=r}run(t){return t===this.o?h(this.h):c({type:"EXPECT_EXACT",value:this.o,source:t})}}class y extends l{constructor(t){super(),this.l=t}run(t){return c(u(this.l,t))}}class E extends l{constructor(t){super(),this.h=t}run(){return h(this.h)}}class w extends l{constructor(t){super(),this.p=t}run(t){if(null==t)return h(null);const r=this.p.decode(t);return null!=r.error?c({type:"OPTIONAL",error:r.error}):r}}class x extends l{constructor(t,r){super(),this.O=t,this.N=r}run(t){if(!e(t))return c(i(t));const r=[];for(const e of Object.keys(t)){const s=this.O(e);if(null!=s.error)return c(u(s.error,e));const i=this.N.decode(t[e]);if(null!=i.error)return c(n(e,i.error));r.push([s.value,i.value])}return h(r)}}class O extends l{constructor(t){super(),this.N=t}run(t){if(!e(t))return c(i(t));const r={};for(const e of Object.keys(t)){const s=this.N.decode(t[e]);if(null!=s.error)return c(n(e,s.error));r[e]=s.value}return h(r)}}class N extends l{constructor(t){super(),this.g=t}run(t){const r={};for(const e of Object.keys(this.g)){const n=this.g[e].decode(t);if(null!=n.error)return n;r[e]=n.value}return h(r)}}class g extends l{constructor(t){super(),this.N=t}run(t){if(!r(t))return c(o(t));const e=Array(t.length);for(let r=0;t.length>r;r++){const n=this.N.decode(t[r]);if(null!=n.error)return c(s(r,n.error));e[r]=n.value}return h(e)}}class T extends l{constructor(t){super(),this.T=t}run(t){const r=[];for(const e of this.T){const n=e.decode(t);if(null==n.error)return n;r.push(n.error)}return c((t=>({type:"ONE_OF",errors:t}))(r))}}class _ extends l{constructor(t,r){super(),this._=t,this.p=r}fieldNotDefined(t){return c({type:"REQUIRED_FIELD",name:this._,source:t})}run(t){if(!e(t))return c(i(t));if(!Object.prototype.hasOwnProperty.call(t,this._))return this.fieldNotDefined(t);const r=this.p.decode(t[this._]);return null!=r.error?c(n(this._,r.error)):r}}class I extends _{fieldNotDefined(){return h(null)}}class A extends l{constructor(t,r){super(),this.I=t,this.p=r}outOfRange(t){return c({type:"REQUIRED_INDEX",position:this.I,source:t})}run(t){if(!r(t))return c(o(t));if(0>this.I||this.I>=t.length)return this.outOfRange(t);const e=this.p.decode(t[this.I]);return null!=e.error?c(s(this.I,e.error)):e}}class R extends A{outOfRange(){return h(null)}}class X{constructor(t){this.A=t}R(t){return this.A(new w(t))}get string(){return this.R(P)}get boolean(){return this.R(L)}get int(){return this.R(F)}get float(){return this.R(j)}list(t){return this.R(V(t))}record(t){return this.R(J(t))}keyValue(...t){return this.R(v(t))}field(t){return Q((r=>this.R(new I(t,r))))}index(t){return Q((r=>this.R(new R(t,r))))}}class b{constructor(t){this.createDecoder=t}of(t){return this.createDecoder(t)}get optional(){return new X(this.createDecoder)}get unknown(){return this.of(D)}get string(){return this.of(P)}get boolean(){return this.of(L)}get int(){return this.of(F)}get float(){return this.of(j)}exact(...t){return this.of(m(t))}lazy(t){return this.of(B(t))}list(t){return this.of(V(t))}tuple(...t){return this.of(U(t))}record(t){return this.of(J(t))}shape(t){return this.of(S(t))}keyValue(...t){return this.of(v(t))}oneOf(...t){return this.of(z(t))}field(t){return Q((r=>this.of(new _(t,r))))}index(t){return Q((r=>this.of(new A(t,r))))}}const C=new X((t=>t)),D=new class extends l{run(t){return h(t)}},P=new p((t=>({type:"EXPECT_STRING",source:t})),(t=>"string"==typeof t)),L=new p((t=>({type:"EXPECT_BOOLEAN",source:t})),(t=>"boolean"==typeof t)),F=new p((t=>({type:"EXPECT_INT",source:t})),(r=>t(r)&&/^(\+|-)?\d+$/.test(""+r))),j=new p((t=>({type:"EXPECT_FLOAT",source:t})),t);function k(t){return new E(t)}const m=t=>new d(t[0],1===t.length?t[0]:t[1]),J=t=>new O(t),S=t=>new N(t),U=t=>{const e=1===t.length&&r(t[0])?t[0]:t,n={},s=e.length;for(let t=0;s>t;t++)n[t]=e[t];return S(n).map((t=>{const r=Array(s);for(let e=0;s>e;e++)r[e]=t[e];return r}))},V=t=>new g(t),v=t=>{const[r,e]=1===t.length?[h,t[0]]:t;return new x(r,e)},z=t=>1===t.length&&r(t[0])?new T(t[0]):new T(t),B=t=>k(null).chain(t),Q=t=>new b((r=>t(r))),G={optional:C,field:t=>Q((r=>new _(t,r))),index:t=>Q((r=>new A(t,r))),unknown:D,string:P,boolean:L,int:F,float:j,exact:(...t)=>m(t),record:J,list:V,keyValue:(...t)=>v(t),shape:S,tuple:(...t)=>U(t),oneOf:(...t)=>z(t),lazy:B,fail:function(t){return new y(t)},succeed:k};export default G;
//# sourceMappingURL=decode-json.mjs.map
